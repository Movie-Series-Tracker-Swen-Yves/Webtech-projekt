<!doctype html>
<html>
<head><meta charset="utf-8"><title>Watchlist</title></head>
<body>
<h2>ðŸŽ¬ Filme <button id="addFilm">+</button></h2>
<table border="1" id="films"><tr><th>Titel</th><th>Minute</th><th>Notiz</th></tr></table>

<h2>ðŸ“º Serien <button id="addSerie">+</button></h2>
<table border="1" id="series"><tr><th>Titel</th><th>Staffel</th><th>Episode</th><th>Minute</th><th>Notiz</th></tr></table>

<script>
    async function load() {
      const films = await fetch('/api/films').then(r=>r.json());
      const series = await fetch('/api/series').then(r=>r.json());
      const ft = document.getElementById('films');
      films.forEach(f=>{
        const tr=document.createElement('tr');
        tr.innerHTML=`<td class="link" data-title="${f.title}">${f.title}</td><td>${f.minute??''}</td><td>${f.notes??''}</td>`;
        tr.onclick=()=> location.href=`/details.html?title=${encodeURIComponent(f.title)}`;
        ft.appendChild(tr);
      });
      const st = document.getElementById('series');
      series.forEach(s=>{
        const tr=document.createElement('tr');
        tr.innerHTML=`<td class="link" data-title="${s.title}">${s.title}</td><td>${s.season??''}</td><td>${s.episode??''}</td><td>${s.minute??''}</td><td>${s.notes??''}</td>`;
        tr.onclick=()=> location.href=`/details.html?title=${encodeURIComponent(s.title)}`;
        st.appendChild(tr);
      });
    }
    document.getElementById('addFilm').onclick=async ()=>{
      const title=prompt('Filmtitel?'); if(!title) return;
      const minute=Number(prompt('Minute?')||0);
      const notes=prompt('Notiz?')||'';
      await fetch('/api/films',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({title,minute,notes})});
      location.reload();
    };
    document.getElementById('addSerie').onclick=async ()=>{
      const title=prompt('Serientitel?'); if(!title) return;
      const season=Number(prompt('Staffel?')||1);
      const episode=Number(prompt('Episode?')||1);
      const minute=Number(prompt('Minute?')||0);
      const notes=prompt('Notiz?')||'';
      await fetch('/api/series',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({title,season,episode,minute,notes})});
      location.reload();
    };
    load();
</script>
</body>
</html>
